# ISA 1

Welcome to your first ISA tutorial! We assume that you have familiarized yourselves with the content from the previous four chapters, but, if not, you will have the time today to catch up on this.

## R outcomes

After this tutorial, you can: 

1. Enter new data 
2. Import and work with existing data 
3. Create frequency tables 
4. Select subsets of data using `dplyr::filter`

## Required packages

You will need the following additional packages:

-   `dplyr` (can also be added by installing the `tidyverse` collection)
-   `haven`

```{r}
#| label: install_load
#| message: FALSE 
#| warning: FALSE
#| eval: FALSE

library(dplyr)
library(haven)

```

## First, create a project!

Follow the [instructions in Chapter 1 of this book](1_r_markdown_basics.qmd#sec-newproj) to create a new R project where you can store all of your ISA scripts, assignments, and datasets. Opening an R Studio session with the newly-created project icon will set the project folder as your home directory, meaning that - if you store all the course datasets here - loading datasets can be performed smoothly without having to enter long directory pathnames to point R to the file you want to load.   

## Entering data

We will work almost exclusively with dataframes on this course. These are essentially tables, where rows correspond to observations on the *unit of analysis* (e.g., mice, people, countries), and columns correspond to variables (e.g., fur colour, occupation, GDP per capita).

Let's create a new dataframe of student names and ages:

```{r}
#| label: gospels

students<-data.frame(names = c("Matthew","Mark","Luke","John"), age = c(18,19,18,20))

```

Above, we assigned a dataframe to the name `students` with the `<-` operator (an alternative to "=" - which also works - used by R). We then told R that we wanted to create a dataframe with variables `names` and `age`, and we provided some values to both of those variables. Here, the `c()` is used to concatenate individual entries into a column vector.

To see our new dataframe in all of its glory, we can simply type its name at the console:

```{r}
#| label: revelation

students
```

If we only want to show a particular variable from the frame, then we type the name of the dataframe and the name of the variable we want to see, separated by the `$` operator:

```{r}
#| label: ages

students$age
```

## Measures of central tendency

In this course, we will consider three measures of central tendency.

### The arithmetic mean

This is usually represented by one of two formulae:

(@)  $\bar{x} = \frac{1}{n} \sum\limits_{i = 1}^{n}x_i$


(@)  $\bar{x} = \frac{\sum_{i = 1}^{n}x_i}{n}$


Straighforwardly: sum all scores and divide by the total number of scores. In R, the arithmetic mean is given by the `mean` function:

```{r mean}

mean(students$age)

```

Strictly speaking, the mean can only be sensibly calculated for interval/ratio level data. 

### The median

This is the 50th percentile in the dataset (i.e., it divides the data into a lower half and an upper half). It is obtained by ranking scores and finding the value which divides the dataset in two. 

For data $x$ with $n$ elements:

* if $n$ is **odd**, $med(x) = x_{(n+1)/2}$
  

* if $n$ is **even**, $med(x) = \frac{x_{(n/2)} + x_{((n/2)+1)}}{2}$

For example, in a sorted dataset with 11 values, the median will be the value at the observation ranked 6th. However, in a sorted dataset with 12 values, the median will be the arithmetic mean of the values ranked in 6th and 7th. In R, we can simply use `median`:

```{r median}

median(students$age)

```

The median can be used to summarize both interval/ratio and ordinal variables.

### The mode

Lastly, we turn to the mode, which is simply the most frequently occurring value. At the time of writing, base R doesn't have a function to compute the mode, so let's write one ourselves:

```{r modefun}

#Hat-tip to #https://www.geeksforgeeks.org/r-language/convert-factor-to-numeric-and-numeric-to-factor-in-r-programming/ for the facto-to-numeric conversion 

cusmode<-function(x){
  xf<-as.data.frame(table(x))
  modeframe<-xf[xf$Freq == max(xf$Freq),]
  names(modeframe)[1]<-"Mode(s)"
  modeframe$`Mode(s)`<-as.numeric(as.character(modeframe$`Mode(s)`)) 
  names(modeframe)[2]<-"Frequency"
  return(modeframe)
}

cusmode(students$age)

```

Datasets can have multiple modes; for example, let's imagine a new student joins the party:

```{r Billy}

students[5,]<-c("Billy",20)

cusmode(students$age)

```

The mode can be calculated for all measurement levels about which you have learned, but it is typically most informative when there are relatively few values which the data can take.

## Importing existing data

We will now import some data from the [European Social Survey](https://www.europeansocialsurvey.org/). The data is saved as .sav, which is a file format native to the SPSS software. We use this as it contains informative labels describing the variables, but the ESS data is also available in .csv and other formats.

Ensure that you have the ESS data saved to your project folder and then run the following:

```{r ESSload, eval = FALSE}

ESS<-haven::read_sav("ESS11.sav")

```

```{r ESSloadreal, echo = FALSE}
ESS<-haven::read_sav("C:/Users/David/OneDrive - UvA/2025_2026/ISA_24_25/Datasets/ESS11.sav")
```

Running the `dplyr::glimpse` command will give us a quick look at the dataset, along with telling us the number of rows (human survey respondents) and columns (variables).

## Summarizing data

### Frequency tables

Frequency give us information about how often each unique value of a variable occurs. In R, we can use the base `table` function to show us the frequency distribution of respondents' `agea`.

```{r ESSage}

table(ESS$agea)

```

### Summary descriptive statistics

The base `summary` function gives us an overview of key descriptive statistics. The counts you see for `NA` (see @nte-na) reflect the number of respondents for whom no information about age was recorded.

```{r ESSagesummary}

summary(ESS$agea)

```

You will notice that the mode is missing, but we can add this to the output using the function `cusmode` we created above:

```{r ESSagesummary_2}

c(summary(ESS$agea),cusmode(ESS$agea))

```

This results in the output being forced to the slightly less reader-friendly list class, but this allows us to quickly display multiple modes where these arise.

## Selecting subsets

```{r filterNE}

```

Coming soon!
